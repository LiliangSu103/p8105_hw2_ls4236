---
title: "p8105_hw2_ls4236"
author: "Liliang Su"
date: "2025-09-23"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Problem 1 

### `pols-month`

First of all, load the required dataset `pols-month` and clean it, and tidy the data according to the first step.

```{r}
pol_df =
  read_csv("./data/pols-month.csv", na = c("NA",".","")) |> 
  janitor::clean_names() |> 
  separate(
    mon,
    into = c("year", "month", "day"),
    sep = "-"
  ) |> 
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    day = as.integer(day)
  ) |> 
  mutate(
    month = case_match(
      month,
      1 ~ "Jan",
      2 ~ "Feb",
      3 ~ "Mar",
      4 ~ "Apr",
      5 ~ "May",
      6 ~ "Jun",
      7 ~ "Jul",
      8 ~ "Aug",
      9 ~ "Sep",
      10 ~ "Oct",
      11 ~ "Nov",
      12 ~ "Dec"
    ),
    month = str_to_lower(month)
  ) |> 
  mutate(
    president = case_when(
      prez_gop == 1 ~ "gop",
      prez_dem == 1 ~ "dem"
    )
  ) |> 
  select(-prez_gop,-prez_dem,-day)

```

### `snp`

Second of all, load the required dataset `snp` and clean it, and tidy the data according to the second step.

```{r}
snp_df =
  read_csv("./data/snp.csv", na = c("NA",".","")) |> 
  janitor::clean_names() |> 
  separate(
    date,
    into = c("month", "day", "year"),
    sep = "/"
  ) |> 
  mutate(
    year = as.integer(year),
    year = ifelse(year < 16, 2000 + year, 1900 + year),
    month = as.integer(month),
    day = as.integer(day)
  ) |> 
  arrange(year, month) |> 
  mutate(
    month = case_match(
      month,
      1 ~ "Jan",
      2 ~ "Feb",
      3 ~ "Mar",
      4 ~ "Apr",
      5 ~ "May",
      6 ~ "Jun",
      7 ~ "Jul",
      8 ~ "Aug",
      9 ~ "Sep",
      10 ~ "Oct",
      11 ~ "Nov",
      12 ~ "Dec"
    ),
    month = str_to_lower(month)
  ) |> 
  relocate(year, month) |> 
  select(-day)


```

### `unemployment`

Third of all, load the required dataset `unemployment` and clean it, and tidy the data according to the third step.

```{r}
une_df =
  read_csv("./data/unemployment.csv", na = c("NA",".","")) |> 
  janitor::clean_names() |> 
  pivot_longer(
    cols = jan:dec,
    names_to = "month",
    values_to = "une_rate"
  )


```

### Merge

Lastly, merge them in the order of `pol`, `snp`, `une`.

```{r}
merge_df =
  pol_df |> 
  left_join(snp_df, by = c("year", "month")) |> 
  left_join(une_df, by = c("year", "month"))

head(merge_df,10)
```

### Summary

Overall, the three datasets together cover a series of political and economic indicators.

The `pols-month` dataset includes 822 observations of 9 dimentions(variables) tracking the number of national politicians monthly by party affiliation, spanning from 1947 to 2015. The key variables include presidential party, number of governors, senators, and representatives of both parties.

The `snp` dataset provide 787 observations of monthly S&P 500 closing values from 1950 to 2015, which can be seen as an indicator of stock market performance.

The `unemployment` dataset contains 68 observations with monthly unemployment rate spanning from 1948 to 2015.

After cleaning and merging, the resulting dataset combines these data into a comprehensive dataset with 822 rows and 11 variables, from 1947 to 2015. Key integrated variables include presidential party affiliation (converted to a single president variable), S&P 500 closing values (close), unemployment rates (une_rate), and detailed counts of politicians by party.
